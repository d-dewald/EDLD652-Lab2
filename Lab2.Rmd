---
title: "Lab2"
author: "Eliott Doyle, Diana DeWald"
date: "1/24/2022"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(fivethirtyeight)
library(fivethirtyeightdata)

# View(google_trends)

```

## 1. Start with the google trends data

### >> Visualize the change in trends for each hurricane over time in one plot with three scales. Map color to a discrete scale.

```{r q1.1, echo = FALSE, warning = FALSE, message = FALSE}

# plotting change in trends over time with three scales
google_trends %>%
  pivot_longer(c("hurricane_harvey_us", "hurricane_irma_us", "hurricane_maria_us", "hurricane_jose_us"),
               names_to = "Hurricane", 
               values_to = "Searches") %>%
  ggplot(aes(date, Searches)) +
  geom_smooth(aes(color = Hurricane), se = FALSE, size = 2) +
  theme_classic() +
  labs(title = "U.S. Google trends for Hurricanes", subtitle = "Aug.-Sep. 2017", x = "Date", y = "Search Frequency (thousands)")+
  scale_color_manual(labels = c("Harvey", "Irma", "Maria", "Jose"),  values = c("darkcyan", "plum4", "lightsalmon", "darkseagreen4")) +
  guides(color=guide_legend("Hurricane"))

```

#### The three scales for our plot are: google search frequency on y-axis (we assume that the values in the dataset were thousands), date on the x-axis, and hurricane on a color scale.

### >> Visualize the trends again, this time with solid shapes (if your first plot was already solid shapes, use lines). Hint, geom_area can be difficult to work with if you have a grouping factor. Try geom_ribbon instead.

```{r q1.2, echo = FALSE, warning = FALSE, message = FALSE}
google_trends$Harvey <- google_trends$hurricane_harvey_us
google_trends$Irma <- google_trends$hurricane_irma_us
google_trends$Jose <- google_trends$hurricane_jose_us
google_trends$Maria <- google_trends$hurricane_maria_us

google_trends %>%
  pivot_longer(c("Harvey", "Irma", "Maria", "Jose"),
               names_to = "Hurricane", 
               values_to = "Searches") %>%
  ggplot(aes(date, Searches)) +
  geom_point(aes(shape = Hurricane), alpha = 0.4, se = FALSE, size = 2) +
  theme_classic() +
  labs(title = "U.S. Google trends for Hurricanes", subtitle = "Aug.-Sep. 2017", x = "Date", y = "Search Frequency (thousands)")

```


### >> Visualize the same relation, but change the scales so color is mapped to a continuous scale (the other scales should be discrete).

```{r q1.3, echo = FALSE, warning = FALSE, message = FALSE}
library(viridis)

google_trends$Harvey <- google_trends$hurricane_harvey_us
google_trends$Irma <- google_trends$hurricane_irma_us
google_trends$Jose <- google_trends$hurricane_jose_us
google_trends$Maria <- google_trends$hurricane_maria_us

google_trends %>%
  pivot_longer(c("Harvey", "Irma", "Maria", "Jose"),
               names_to = "Hurricane", 
               values_to = "Searches") %>%
  ggplot(aes(date, Hurricane)) +
  geom_tile(aes(fill = Searches, stat="identity", width=1, height=.9)) + 
  theme_classic() +
  labs(title = "U.S. Google trends for Hurricanes", subtitle = "Aug.-Sep. 2017", x = "Date", y = "Hurricane") +
  scale_fill_viridis()

```